(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))u(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const s of t.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&u(s)}).observe(document,{childList:!0,subtree:!0});function d(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function u(e){if(e.ep)return;e.ep=!0;const t=d(e);fetch(e.href,t)}})();function S(){const n=localStorage.getItem("students");if(n)try{const a=JSON.parse(n);if(Array.isArray(a))return a}catch{return[]}return[]}function p(n){localStorage.setItem("students",JSON.stringify(n))}function y(n){const a=document.createElement("div");a.classList.add("line"),a.dataset.id=n.id,n.payments===0&&a.classList.add("danger"),a.innerHTML=`
        <div class="cell" data-key="name">
            <span class="text" contenteditable>${x(n.name)}</span>
        </div>
        <div class="cell" data-key="payments">
            <span class="text" contenteditable data-allow-regex="[0-9]">${x(n.payments)}</span>
        </div> 

        <button class="delete-button" title="Excluir aluna">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash2-icon lucide-trash-2">
                <path d="M10 11v6"/>
                <path d="M14 11v6"/>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"/>
                <path d="M3 6h18"/>
                <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
            </svg>
        </button>
    `,document.querySelector(".scroller").appendChild(a)}function C(n){const a=document.querySelector(`.line[data-id="${n.id}"]`);if(!a)return;const d=a.querySelector('.cell[data-key="name"] .text'),u=a.querySelector('.cell[data-key="payments"] .text');d.textContent=n.name,u.textContent=String(n.payments),n.payments===0&&a.classList.add("danger")}function g(n){const a=document.querySelector(".students-counter"),d=a.querySelector(".count"),u=a.querySelector(".text");n===0?(d.textContent="",u.textContent="Nenhuma aluna cadastrada"):(d.textContent=String(n),u.textContent=n===1?"aluna cadastrada":"alunas cadastradas")}function x(n){const a=document.createElement("div");return a.textContent=String(n),a.innerHTML}function E(){const n=S();g(n.length);for(const e of n)y(e);document.querySelector(".add-student-button").addEventListener("click",()=>{const e=prompt("Digite o nome da aluna:");if(e===null)return;if(!e){alert("O nome da aluna é obrigatório!");return}const t=crypto.randomUUID(),s=0,i=Date.now(),r={id:t,name:e,payments:s,createdAt:i};n.push(r),p(n),y(r),g(n.length)}),document.querySelector(".scroller").addEventListener("click",e=>{const t=e.target;if(t.closest(".delete-button")){const s=t.closest(".line"),i=s.dataset.id,r=n.findIndex(o=>o.id===i);if(r>-1){const o=n[r];confirm(`Tem certeza que deseja excluir a aluna "${o.name}"?`)&&(n.splice(r,1),p(n),s.remove(),g(n.length))}else alert("erro: aluna não encontrada!"),s.remove()}}),document.querySelector(".finish-class-button").addEventListener("click",()=>{if(confirm(`Tem certeza que deseja finalizar a aula?
Isso irá diminuir 1 aula de todas as alunas que possuem aulas pagas.`)){for(const s of n)s.payments-=1,s.payments<0&&(s.payments=0);p(n);for(const s of n)C(s)}}),document.addEventListener("paste",e=>{const t=e.target;if(!t.isContentEditable)return;e.preventDefault();let s=e.clipboardData?.getData("text/plain");if(!s)return;const i=t.dataset.allowRegex;if(i){const m=new RegExp(i);s=s.split("").filter(h=>m.test(h)).join("")}document.execCommand("insertText",!1,s);const r=t.closest(".cell");if(!r)return;const o=r.dataset.key;if(!o)return;const c=r.closest(".line");if(!c)return;const l=c.dataset.id;if(!l)return;const f=n.find(m=>m.id===l);if(f){if(o==="name")f.name=t.textContent||"";else if(o==="payments"){const m=Number(t.textContent||"0");if(isNaN(m))return;f.payments=m,f.payments<0&&(f.payments=0),c.classList.toggle("danger",f.payments===0)}p(n)}}),document.addEventListener("keydown",e=>{const t=e.target;if(!t.isContentEditable)return;if(!e.ctrlKey&&!e.shiftKey&&!e.altKey&&e.key==="Enter"){e.preventDefault(),t.blur();return}let s=t.textContent||"";const i=t.dataset.allowRegex;if(i){const r=new RegExp(i);if(!e.ctrlKey&&!e.shiftKey&&!e.altKey&&e.key.length===1&&!r.test(e.key)){e.preventDefault();return}s=s.split("").filter(o=>r.test(o)).join("")}if(s!==t.textContent){const r=window.getSelection();if(!r)return;const c=r.getRangeAt(0).startOffset;t.textContent=s;const l=document.createRange();l.setStart(t.childNodes[0]||t,Math.min(c,s.length)),l.collapse(!0),r.removeAllRanges(),r.addRange(l)}}),document.addEventListener("keyup",e=>{const t=e.target;if(!t.isContentEditable)return;const s=t.closest(".cell");if(!s)return;const i=s.dataset.key;if(!i)return;const r=s.closest(".line");if(!r)return;const o=r.dataset.id;if(!o)return;const c=n.find(l=>l.id===o);if(c){if(i==="name")c.name=t.textContent||"";else if(i==="payments"){const l=Number(t.textContent||"0");if(isNaN(l))return;c.payments=l,c.payments<0&&(c.payments=0),r.classList.toggle("danger",c.payments===0)}p(n)}}),document.addEventListener("click",e=>{const t=e.target;if(!t.isContentEditable)return;const s=t.closest(".cell");if(!s)return;const i=s.dataset.key;if(!i||i!=="payments")return;const r=document.createRange();r.selectNodeContents(t);const o=window.getSelection();o&&(o.removeAllRanges(),o.addRange(r))})}E();
